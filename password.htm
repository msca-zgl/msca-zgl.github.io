<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>密码工具</title>
        <script>
            pass=0
            pl1=[]
            pl2=[]
            pll=205743
            console.log('PassWoord Tool')
            /*
                索引    内容
            pl1 明文    密文
            pl2 密文    明文
            */
            function value1(){
                return document.getElementById("1").value;
            }
            function value2(){
                return document.getElementById("2").value;
            }
            function ans(x){
                document.getElementById("ans").innerHTML=x;
            }
            function ToInt(x){
                a=[]
                for(i=0;i<x.length;i++){
                    a.push(x.charAt(i).charCodeAt())
                }
                return a
            }
            function ToStr(x){
                a=''
                for(i=0;i<x.length;i++){
                    a+=String.fromCharCode(x[i])
                }
                return a
            }
            function mpl(){
                pl1=[]
                pl2=[]
                for(i=0;i<pll;i++){
                    pl1.push(i)
                    pl2.push(i)
                }
                num=Math.round(pass*pass*pass*0.567+pass*pass*0.314+pass*1.428+5.234)
                for(i=0;i<pll;i++){
                    x=Math.round(pass*pass*pass*0.234+pass*pass*0.926+pass*5.714+5.345)
                    x=Math.round(x*x*i*0.6+x*i*0.5+x+5.114);
                    [pl1[x%pll],pl1[i]]=[pl1[i],pl1[x%pll]]
                }
                for(i=0;i<pll;i++){
                    pl2[pl1[i]]=i
                }
            }

            function p0(){
                pass=Number(String(ToInt(value2())).split(',').join(''))
                mpl()
                a=ToInt(value1())
                for(i=0;i<a.length;i++){
                    a[i]=pl1[a[i]]
                }
                ans(a)
            }
            function p1(){
                pass=Number(String(ToInt(value2())).split(',').join(''))
                mpl()
                a=eval('['+value1()+']')
                for(i=0;i<a.length;i++){
                    a[i]=pl2[a[i]]
                }
                ans(ToStr(a))
            }
            function copy(){
                document.body.addEventListener(
                    'click',
                    async (e) => {
                    await navigator.clipboard.writeText(document.getElementById("ans").innerHTML)
                    }
                )
            }
        </script>
    </head>
    <body>
        <div>
            密码工具v1.1<br>
            ===MSCA===<br>
            提示：<br>
            加密后的密文没有字母！<br>
            将要加密或要解密的文本复制入'文本'输入框中<br>
            如果结果较长，请点击'复制结果'按钮<br>
        </div>
        <!--更新摘要：
            v1.0 无
            v1.1 允许使用带字母的密码,加入多行输入框与自动断行-->
        文本<br><textarea id="1" rows="10" cols="100"></textarea><br>
        密码<input id="2"><br>
        <button onclick="p0()">加密</button>
        <button onclick="p1()">解密</button>
        <button onclick="copy()">复制结果</button>
        <br>
        <p>结果:</p>
        <div id="ans" rows="10" cols="100"></div>
        <style>
            #ans{
              word-wrap: break-word;
            }
          </style>
    </body>
</html>
